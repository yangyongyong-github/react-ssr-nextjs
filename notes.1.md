支持ssr的框架：umijs nextjs

# 1. 搭建基本工程
npm i next react react-dom
pages 自动当成页面以及自动配置路由，还支持src文件夹
默认开启了热替换
打包完成后运行该文件时 npm run srart （运行打包后的文件）
每个页面做了优化，用到了才会加载

# 2.路由

1. 模板 每页的页头页尾等 `_app.jsx` 编写模板页面
2. 路由
3. 动态路由 /movie/[id].js => /movie/:id   :id 写的时候为数字
 多断动态路由 [...parms].jsx  a/c/d/b query: params:[a,c,d,b]

4. 路由跳转
   1. 链接式跳转 
    <Link href="主键地址（.jsx文件）"><a>Page</a> </Link>
=>
    <Link href="/movies/[id]" as="/movies/3"> 

   2. 代码式跳转
    <button onClick={()=>{
        router.push("/movies/[...params]","/movies/a/s/c")
    }}
    >To</button>

5. 404页面
6. 错误页面 _error.jsx 
    找不到404的时候，就找该页面

# 注意：
1. 路由文件时。'/'文件代表着 pages 文件夹(没有src的情况下)

————————————————————————————————————————————————————————————————

# 3. 静态化

Client：　div#root => 后续渲染，注水
前端server： 开始耗费资源了，每一次请求需要渲染一次，以前是client、自己渲染
实际上，没必要每次都去ssr渲染
=> 
一开始根据Router 页面数量内容等 渲染好，请求过来的时候，仅需要给这个静态页面即可

`static optimization indicator` 静态优化器

## 根据每一个页面的不同决定是要 SSR or SSG ?

默认时，尽量开启SSG，尤其在生产环境中启用（如果开发阶段启用了，代码变动后不会发生变化了），打包后为生产环境

自动优化器完成，纯粹的组件，

----------------------------------------------

# 4. pre-render： 预渲染

1. 静态化

发生的时间：next build

什么时候要使用静态化?
    如果你的页面不是根据不同的请求而不同，则推荐使用静态化

## 1). 纯静态化

打包的时候，全部渲染一遍，将一些页面变为 真正的静态化页面
server 及大了降低了渲染压力

## 2). SSG: server static generator

有数据的时候，不希望静态化，这时一般使用SSG
下面的两个函数必须在页面中，且都是在**当渲染组件之前会运行**
服务端渲染、bulid

> `getStaticProps`:  生成html + json
-   当渲染组件之前会进行
-   函数的返回结果 放到页面的数据中去
-   和纯静态化的区别是：先运行该函数，在进行纯静态化

> `getStaticPaths`:  解决动态路由

**fallback**: 
-   false: 什么都不做，如果没有静态页面，返回404
-   true: 会给[id].html

**动态路由的问题 ?**
    获取id一定是 client用户输入的时候的，但是这里的构建的时候，没有id，这时候咋办？
    打包的时候，针对每一个动态路由 生成很多个静态页面

但是，这里需要面对的问题是：
1. 不可能将每一个id都生成静态页面  => 生成最近的热门的一些 `fallback`
-   当你访问不存在的页面的时候，返回给你 响应[id] .html，同时请求JSON，
-   （重新渲染组件，把组件结果生成到一个新的HTML中）
    与此同时 服务器马上启动 getStaticProps,自动传递新的路由，再服务器端生成新的页面
-   同时生成Json，



2. SSR： server side render  服务端渲染

pages / api文件夹，在服务器端 运行的请求处理文件
根据每一次请求获取数据，进行渲染

